/* Focus: Snap Back card + panel */

.snapback-tool {
  width: 100%;
  max-width: min(720px, 100%);
  display: flex;
  justify-content: center;
}

.snapback-tool__card {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: clamp(0.9rem, 2.6vw, 1.4rem);
  padding: clamp(0.9rem, 2.6vw, 1.4rem) clamp(1.1rem, 3vw, 1.8rem);
  border-radius: clamp(14px, 3.2vw, 20px);
  border: 1px solid rgba(108, 134, 255, 0.35);
  background: linear-gradient(155deg, rgba(40, 52, 120, 0.92) 0%, rgba(24, 32, 78, 0.94) 60%, rgba(12, 18, 44, 0.96) 100%);
  box-shadow: 0 24px 52px -28px rgba(4, 10, 32, 0.8), inset 0 0 0 1px rgba(255, 255, 255, 0.05);
}
  
.snapback-tool__body {
  display: flex;
  flex-direction: column;
  gap: clamp(0.35rem, 1.2vw, 0.6rem);
  max-width: 70%; 
}
  
.snapback-tool__title {
  margin: 0;
  font-family: var(--font-display);
  font-size: clamp(1.1rem, 2.8vw, 1.45rem);
  font-weight: 600;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: rgba(226, 230, 255, 0.92);
}

.snapback-tool__text {
  margin: 0;
  color: rgba(206, 212, 255, 0.75);
  font-size: clamp(0.85rem, 2vw, 0.98rem);
  line-height: 1.55;
}

.snapback-tool__last {
  margin: 0;
  font-size: clamp(0.78rem, 1.8vw, 0.9rem);
  color: rgba(180, 192, 255, 0.7);
}

.snapback-tool__button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  /* Make button visibly larger: ~50% of viewport, but never overflow container */
  width: min(50vw, 600px);
  max-width: 100%;
  padding: clamp(0.6rem, 1.8vw, 0.85rem) clamp(1.4rem, 3.4vw, 2rem);
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.12);
  background: linear-gradient(135deg, #3a6df0 0%, #5b4ee0 50%, #7e3af2 100%);
  color: #ffffff;
  font-family: var(--font-display);
  font-size: clamp(0.9rem, 2.2vw, 1rem);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.18s ease;
  will-change: transform;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.snapback-tool__button:hover,
.snapback-tool__button:focus-visible {
  transform: translateY(-1px);
}

.snapback-tool__button:focus-visible {
  outline: 2px solid rgba(172, 192, 255, 0.9);
  outline-offset: 2px;
}

.snapback-overlay {
  position: fixed;
  inset: 0;
  background: linear-gradient(160deg, rgba(6, 10, 26, 0.78) 0%, rgba(12, 16, 38, 0.78) 50%, rgba(18, 24, 52, 0.78) 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: clamp(1.2rem, 4vw, 2rem);
  z-index: 140;
}

.snapback-panel {
  width: min(480px, 100%);
  display: flex;
  flex-direction: column;
  gap: clamp(0.5rem, 1.6vw, 0.8rem);
  padding: clamp(0.8rem, 2.4vw, 1.2rem);
  border-radius: clamp(16px, 3.6vw, 22px);
  border: 1px solid rgba(128, 152, 236, 0.4);
  background: linear-gradient(155deg, rgba(34, 42, 86, 0.95) 0%, rgba(20, 28, 60, 0.96) 60%, rgba(12, 18, 40, 0.98) 100%);
  box-shadow:
    0 36px 72px -32px rgba(2, 6, 32, 0.85),
    inset 0 0 0 1px rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(26px);
  outline: none;
}

.snapback-panel__header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: clamp(0.6rem, 1.6vw, 1rem);
}

.snapback-panel__heading {
  display: flex;
  flex-direction: column;
  gap: clamp(0.2rem, 0.9vw, 0.35rem);
}

.snapback-panel__close {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: clamp(2rem, 4vw, 2.2rem);
  height: clamp(2rem, 4vw, 2.2rem);
  border-radius: 999px;
  border: 1px solid rgba(156, 176, 255, 0.36);
  background: rgba(68, 84, 168, 0.25);
  color: rgba(214, 222, 255, 0.82);
  font-size: 1.2rem;
  line-height: 1;
  cursor: pointer;
  transition: transform 0.18s ease, border-color 0.2s ease, background 0.2s ease, color 0.2s ease;
}

.snapback-panel__close:hover,
.snapback-panel__close:focus-visible {
  border-color: rgba(188, 202, 255, 0.5);
  background: rgba(86, 104, 198, 0.32);
  color: rgba(255, 255, 255, 0.92);
  transform: none;
}

.snapback-panel__close:focus-visible {
  outline: 2px solid rgba(170, 190, 255, 0.65);
  outline-offset: 2px;
}

.snapback-panel__title {
  margin: 0;
  font-family: var(--font-display);
  font-size: clamp(1.1rem, 2.4vw, 1.4rem);
  font-weight: 600;
  letter-spacing: 0.015em;
  color: rgba(236, 240, 255, 0.96);
}

.snapback-panel__lead {
  margin: 0;
  font-size: clamp(0.76rem, 1.6vw, 0.9rem);
  color: rgba(198, 208, 255, 0.76);
}

.snapback-panel__context {
  display: flex;
  flex-direction: column;
  gap: clamp(0.12rem, 0.9vw, 0.28rem);
  padding: clamp(0.45rem, 1.3vw, 0.65rem) clamp(0.7rem, 1.8vw, 0.95rem);
  border-radius: clamp(10px, 2vw, 14px);
  background: rgba(24, 30, 70, 0.5);
  border: 1px solid rgba(128, 150, 240, 0.25);
}

.snapback-panel__context-label {
  font-size: clamp(0.62rem, 1.4vw, 0.72rem);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: rgba(188, 198, 255, 0.64);
}

.snapback-panel__context-task {
  font-family: var(--font-display);
  font-size: clamp(0.8rem, 2vw, 0.95rem);
  font-weight: 600;
  color: rgba(226, 232, 255, 0.86);
}

.snapback-panel__context-meta {
  font-size: clamp(0.66rem, 1.4vw, 0.78rem);
  color: rgba(174, 188, 255, 0.64);
}

.snapback-panel__content {
  display: flex;
  flex-direction: column;
  gap: clamp(0.6rem, 1.6vw, 0.9rem);
}

.snapback-panel__grid {
  display: grid;
  gap: clamp(0.5rem, 1.4vw, 0.8rem);
  grid-template-columns: minmax(0, 1fr);
}

.snapback-panel__section {
  display: flex;
  flex-direction: column;
  gap: clamp(0.45rem, 1.4vw, 0.7rem);
  padding: clamp(0.5rem, 1.4vw, 0.75rem);
  border-radius: clamp(12px, 2.2vw, 14px);
  border: 1px solid rgba(128, 148, 240, 0.2);
  background: rgba(20, 26, 60, 0.5);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.snapback-panel__section--stretch { min-height: 100%; }
.snapback-panel__section--compact { gap: clamp(0.5rem, 1.4vw, 0.75rem); }

.snapback-panel__heading {
  margin: 0;
  font-size: clamp(0.88rem, 2vw, 1rem);
  font-weight: 600;
  color: rgba(210, 220, 255, 0.9);
}

.snapback-panel__chips {
  display: flex;
  flex-wrap: wrap;
  gap: clamp(0.35rem, 1.4vw, 0.6rem);
}

.snapback-option {
  padding: 0.4rem 0.8rem;
  border-radius: 999px;
  border: 1px solid rgba(150, 170, 255, 0.38);
  background: rgba(60, 72, 156, 0.38);
  color: rgba(220, 228, 255, 0.88);
  font-size: clamp(0.78rem, 1.6vw, 0.9rem);
  cursor: pointer;
  backdrop-filter: blur(12px);
  transition: border-color 0.2s ease, background 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
}

.snapback-option:focus-visible {
  border-color: rgba(186, 202, 255, 0.55);
  background: rgba(92, 108, 198, 0.54);
  transform: none;
  box-shadow: none;
}

.snapback-option:focus-visible { outline: 2px solid rgba(172, 186, 255, 0.7); outline-offset: 2px; }

/* Focus: Focus selector, focus card, stopwatch, notes */
/* Page-level positioning for actions */
.taskwatch-page { position: relative; }
/* Allow Focus dashboard to span a wider canvas than the default site width */
.taskwatch-page.taskwatch--dashboard.site-main__inner { width: min(1160px, 100%); }
/* Remove top/bottom padding in dashboard view */
.taskwatch-page.taskwatch--dashboard.site-main__inner { padding-block: 0; }
/* Add some breathing room at the bottom in dashboard view */
.taskwatch-page.taskwatch--dashboard.site-main__inner { padding-bottom: clamp(2.5rem, 7vw, 4.5rem); }
.taskwatch-page-actions { position: absolute; top: clamp(0.6rem, 2.2vw, 1rem); right: clamp(0.6rem, 2.2vw, 1rem); z-index: 2; }

/* Dashboard toggle styles (match Goals) */
.taskwatch-layout-toggle {
  flex: 0 0 auto;
  font-size: 0.72rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  padding: 0.45rem 0.7rem;
  border-radius: 0.75rem;
  border: 1px solid rgba(114, 138, 255, 0.38);
  background: rgba(24, 34, 84, 0.68);
  color: rgba(230, 238, 255, 0.94);
  transition: background 0.18s ease, color 0.18s ease, border-color 0.18s ease, transform 0.18s ease;
}
.taskwatch-layout-toggle:hover,
.taskwatch-layout-toggle:focus-visible { background: rgba(30, 44, 112, 0.82); border-color: rgba(139, 132, 255, 0.5); color: #35d4ff; transform: translateY(-1px); outline: none; }
.taskwatch-layout-toggle--active { background: rgba(31, 200, 255, 0.16); border-color: rgba(31, 200, 255, 0.4); color: #35d4ff; }
html[data-theme='light'] .taskwatch-layout-toggle { background: rgba(92, 91, 255, 0.16); border-color: rgba(92, 91, 255, 0.3); color: rgba(24, 30, 86, 0.94); }
html[data-theme='light'] .taskwatch-layout-toggle--active { background: rgba(31, 200, 255, 0.18); border-color: rgba(31, 200, 255, 0.32); color: rgba(20, 26, 78, 0.96); }

/* Dashboard layout: two columns (no grid) */
/* Container remains standard block; columns wrapper handles layout */
.taskwatch--dashboard { display: block; }
.taskwatch-header { width: 100%; display: flex; align-items: center; justify-content: space-between; gap: 0.75rem; }

/* Columns wrapper */
.taskwatch-columns {
  --col-gap: clamp(1.4rem, 3.8vw, 2rem);
  --row-gap: clamp(0.02rem, 0.2vw, 0.12rem);
  display: flex;
  align-items: stretch;
  gap: var(--col-gap);
  /* Add breathing room below the columns so the meta note doesn't butt up against them */
  margin-bottom: clamp(1.2rem, 4.5vw, 2.6rem);
}
/* In dashboard view, push columns further from the meta note */
.taskwatch--dashboard .taskwatch-columns { margin-bottom: clamp(2rem, 6vw, 3.6rem); }
.taskwatch-col { flex: 1 1 0; min-width: 0; display: flex; flex-direction: column; gap: var(--row-gap); }
.taskwatch-col--left { padding-right: 0; gap: clamp(0.6rem, 2.2vw, 1.2rem); }
.taskwatch-col--right { padding-left: 0; border-left: none; }

/* Make cards fill column width */
.taskwatch--dashboard .task-selector-container,
.taskwatch--dashboard .stopwatch-card,
.taskwatch--dashboard .snapback-tool,
.taskwatch--dashboard .taskwatch-notes,
.taskwatch--dashboard .taskwatch-subtasks-card,
.taskwatch--dashboard .taskwatch-notes-card { max-width: none !important; width: 100% !important; }

/* Stack on small screens; hide vertical separator
   Keep two columns until the viewport is quite small */
@media (max-width: 840px) {
  .taskwatch-columns { flex-direction: column; }
  .taskwatch-col--left { padding-right: 0; }
  .taskwatch-col--right { padding-left: 0; }
}

/* Snapback respects default internal sizing to preserve standard styles */
/* (No dashboard-specific snapback button sizing) */

/* Use standard card paddings and internal spacing in dashboard */
/* (no overrides here; base .stopwatch-card/.focus-task styles apply) */

/* Notes card keeps its standard padding/gaps in dashboard */

/* Remove extra vertical margins; rely on column gap */
.taskwatch--dashboard .task-selector-container,
.taskwatch--dashboard .stopwatch-card,
.taskwatch--dashboard .snapback-tool,
.taskwatch--dashboard .taskwatch-notes { margin-top: 0 !important; margin-bottom: 0 !important; }

/* Use standard focus-task surface and spacing in dashboard */

/* Align right column to top and remove extra top margin so it sits level with the selector */
.taskwatch--dashboard .taskwatch-notes { align-self: start; justify-self: stretch; margin-top: 0; }

/* Selector trigger + popover */
.task-selector-container {
  position: relative;
  width: min(720px, 100%);
}

.task-selector {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: clamp(0.6rem, 2vw, 1rem);
  padding: clamp(0.85rem, 3vw, 1.1rem) clamp(1rem, 3.4vw, 1.45rem);
  border-radius: 1.1rem;
  border: 1px solid var(--panel-border);
  background: var(--panel-background);
  color: var(--text-primary);
  font-family: var(--font-display);
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: none;
  cursor: pointer;
  box-shadow: var(--panel-shadow);
  transition: border-color 180ms ease, box-shadow 180ms ease, transform 180ms ease;
}

.task-selector:hover,
.task-selector:focus-visible {
  border-color: var(--accent);
  box-shadow: 0 18px 40px var(--glow);
}

.task-selector:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 3px;
}

.task-selector--open {
  box-shadow: 0 24px 48px var(--glow);
}

/* Dashboard: remove any shadow from selector trigger/panel */
.taskwatch--dashboard .task-selector { box-shadow: none !important; }
.taskwatch--dashboard .task-selector:hover,
.taskwatch--dashboard .task-selector:focus-visible,
.taskwatch--dashboard .task-selector--open { box-shadow: none !important; }
.taskwatch--dashboard .task-selector-popover { box-shadow: none !important; }
.taskwatch--dashboard .focus-task { box-shadow: none !important; }

/* Standard view (Focus page): remove selector/focus shadows as well */
.taskwatch-page .task-selector { box-shadow: none !important; }
.taskwatch-page .task-selector:hover,
.taskwatch-page .task-selector:focus-visible,
.taskwatch-page .task-selector--open { box-shadow: none !important; }
.taskwatch-page .task-selector-popover { box-shadow: none !important; }
.taskwatch-page .focus-task { box-shadow: none !important; }

.task-selector__text {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: clamp(0.2rem, 1vw, 0.35rem);
}

.task-selector__label {
  font-size: clamp(0.8rem, 2vw, 0.95rem);
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--text-secondary);
}

.task-selector__value {
  font-size: clamp(1rem, 3vw, 1.25rem);
  letter-spacing: 0.05em;
  color: var(--text-primary);
  line-height: 1.3;
  text-align: left;
}

.task-selector__value--placeholder {
  color: var(--text-muted);
}

.task-selector__icon {
  flex: 0 0 auto;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: clamp(1.6rem, 5vw, 2rem);
  height: clamp(1.6rem, 5vw, 2rem);
  color: var(--text-secondary);
  transition: transform 180ms ease;
}

.task-selector--open .task-selector__icon {
  transform: rotate(180deg);
}

.task-selector-popover {
  position: absolute;
  top: calc(100% + clamp(0.6rem, 2vw, 0.9rem));
  right: 0;
  width: min(clamp(360px, 90vw, 480px), calc(100vw - 1.5rem));
  max-height: clamp(280px, 65vh, 520px);
  padding: clamp(1rem, 3vw, 1.4rem);
  border-radius: 1rem;
  border: 1px solid var(--panel-border);
  background: var(--panel-background-solid, var(--panel-background));
  box-shadow: var(--panel-shadow);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: clamp(1rem, 3vw, 1.5rem);
  z-index: 30;
  overscroll-behavior: contain;
}

.task-selector-popover:focus { outline: none; }
.task-selector-popover:focus-visible { outline: 2px solid var(--accent); outline-offset: 4px; }

.task-selector__section { display: flex; flex-direction: column; gap: clamp(0.6rem, 2vw, 0.9rem); }
.task-selector__section-title { margin: 0; font-size: clamp(0.85rem, 2.2vw, 1rem); letter-spacing: 0.15em; text-transform: uppercase; color: var(--text-secondary); }

.task-selector__custom-form { display: flex; gap: 0.55rem; align-items: stretch; flex-wrap: wrap; }
.task-selector__input {
  flex: 1 1 auto;
  min-width: 0;
  border-radius: 0.75rem;
  border: 1px solid var(--control-border);
  background: var(--control-surface);
  padding: 0.65rem 0.9rem;
  font-family: var(--font-body);
  font-size: 0.95rem;
  color: var(--text-primary);
  transition: border-color 160ms ease, background 160ms ease, box-shadow 160ms ease;
}
.task-selector__input::placeholder { color: var(--text-muted); }
.task-selector__input:focus-visible { outline: none; border-color: var(--accent); background: var(--control-surface-hover); box-shadow: 0 0 0 2px var(--accent-soft); }

.task-selector__set-button { flex: 0 0 auto; border: none; border-radius: 0.7rem; padding: 0.6rem 0.9rem; font-size: 0.85rem; letter-spacing: 0.08em; text-transform: uppercase; font-weight: 600; background: var(--accent); color: var(--text-control-contrast); cursor: pointer; box-shadow: var(--control-shadow); transition: transform 150ms ease; }
.task-selector__set-button:active { transform: translateY(1px); }

.task-selector__clear-button { align-self: flex-end; border: none; background: none; color: var(--text-secondary); font-size: 0.85rem; letter-spacing: 0.08em; text-transform: uppercase; cursor: pointer; padding: 0; }
.task-selector__clear-button:disabled { opacity: 0.45; cursor: default; }

.task-selector__list,
.task-selector__goals,
.task-selector__buckets,
.task-selector__tasks { list-style: none; margin: 0; padding: 0; display: flex; flex-direction: column; gap: 0.4rem; }

.task-selector__task {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 0.18rem;
  border: 1px solid var(--surface-border, transparent);
  border-radius: 0.85rem;
  padding: 0.65rem 0.85rem;
  background: var(--surface-bg, var(--control-surface));
  color: var(--text-primary);
  text-align: left;
  cursor: pointer;
  box-shadow: var(--surface-shadow, none);
  transition: border-color 150ms ease, background 150ms ease, transform 150ms ease;
}
.task-selector__task:hover,
.task-selector__task:focus-visible { border-color: var(--surface-border-hover, var(--surface-border, var(--control-border))); background: var(--surface-bg-hover, var(--surface-bg, var(--control-surface-hover))); }
.task-selector__task.goal-task-row { display: block; border: none; padding: 0.7rem 0.9rem; background: var(--task-row-bg); box-shadow: none; }
.task-selector__task.goal-task-row:hover,
.task-selector__task.goal-task-row:focus-visible { border: none; background: var(--task-row-bg); }
.task-selector__task.goal-task-row:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
.task-selector__task.goal-task-row .goal-task-diff { pointer-events: none; cursor: default; }

.task-selector__task-main { display: grid; grid-template-columns: 1fr auto; align-items: center; gap: 0.6rem; width: 100%; min-width: 0; }
.task-selector__task-content { display: flex; flex-direction: column; gap: 0.45rem; min-width: 0; }
.task-selector__task.goal-task-row .goal-task-text { display: block; color: inherit; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 100%; word-break: break-word; }

/* Life routine surfaces in selector and focus */
.task-selector__task--life-routine { color: var(--taskwatch-life-text, var(--text-primary)); }
.task-selector__task--life-routine .goal-task-text,
.task-selector__task--life-routine .goal-task-text__inner { color: inherit; }
.task-selector__task--life-routine .task-selector__origin,
.task-selector__task--life-routine .task-selector__origin--dropdown { color: var(--taskwatch-life-muted, var(--text-secondary)); }
.focus-task.surface-life-routine { color: var(--taskwatch-life-text, var(--text-primary)); }
.focus-task.surface-life-routine .focus-task__name,
.focus-task.surface-life-routine .goal-task-text__inner { color: inherit; }
.focus-task.surface-life-routine .focus-task__label,
.focus-task.surface-life-routine .focus-task__origin { color: var(--taskwatch-life-muted, var(--text-secondary)); }
.goal-task-row.surface-life-routine { --task-row-shadow: 0 18px 36px rgba(8, 12, 38, 0.45); --task-row-overlay: linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.04)); --taskwatch-life-text: var(--text-primary); --taskwatch-life-muted: var(--text-secondary); }
.goal-task-row.surface-life-routine--glass { --task-row-bg: linear-gradient(135deg, rgba(48, 64, 120, 0.22), rgba(26, 34, 78, 0.18)); --task-row-border: rgba(118, 142, 255, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(148, 163, 255, 0.24), rgba(99, 102, 241, 0.16)); --taskwatch-life-text: rgba(235, 240, 255, 0.92); --taskwatch-life-muted: rgba(210, 220, 255, 0.72); }
.goal-task-row.surface-life-routine--midnight { --task-row-bg: linear-gradient(135deg, rgba(118, 126, 255, 0.2), rgba(92, 106, 230, 0.16)); --task-row-border: rgba(142, 149, 255, 0.34); --task-row-overlay: linear-gradient(135deg, rgba(172, 154, 255, 0.26), rgba(110, 122, 255, 0.18)); --taskwatch-life-text: rgba(235, 233, 255, 0.92); --taskwatch-life-muted: rgba(202, 204, 255, 0.72); }
.goal-task-row.surface-life-routine--slate { --task-row-bg: linear-gradient(135deg, rgba(151, 227, 255, 0.2), rgba(96, 180, 255, 0.14)); --task-row-border: rgba(120, 198, 255, 0.3); --task-row-overlay: linear-gradient(135deg, rgba(151, 227, 255, 0.24), rgba(96, 180, 255, 0.16)); --taskwatch-life-text: rgba(220, 244, 255, 0.92); --taskwatch-life-muted: rgba(186, 222, 255, 0.74); }
.goal-task-row.surface-life-routine--charcoal { --task-row-bg: linear-gradient(135deg, rgba(255, 188, 213, 0.22), rgba(244, 174, 206, 0.16)); --task-row-border: rgba(231, 174, 206, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(255, 188, 213, 0.26), rgba(244, 173, 212, 0.18)); --taskwatch-life-text: rgba(255, 232, 245, 0.92); --taskwatch-life-muted: rgba(255, 210, 235, 0.7); }
.goal-task-row.surface-life-routine--linen { --task-row-bg: linear-gradient(135deg, rgba(255, 214, 170, 0.22), rgba(255, 233, 192, 0.16)); --task-row-border: rgba(255, 201, 150, 0.3); --task-row-overlay: linear-gradient(135deg, rgba(255, 214, 170, 0.26), rgba(249, 173, 94, 0.18)); --taskwatch-life-text: rgba(255, 244, 230, 0.92); --taskwatch-life-muted: rgba(255, 224, 198, 0.7); }
.goal-task-row.surface-life-routine--frost { --task-row-bg: linear-gradient(135deg, rgba(174, 233, 255, 0.2), rgba(142, 210, 255, 0.14)); --task-row-border: rgba(124, 222, 255, 0.3); --task-row-overlay: linear-gradient(135deg, rgba(174, 233, 255, 0.24), rgba(142, 210, 255, 0.16)); --taskwatch-life-text: rgba(224, 248, 255, 0.92); --taskwatch-life-muted: rgba(190, 236, 255, 0.72); }
.goal-task-row.surface-life-routine--grove { --task-row-bg: linear-gradient(135deg, rgba(140, 255, 204, 0.26), rgba(74, 222, 128, 0.16)); --task-row-border: rgba(74, 222, 128, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(140, 255, 204, 0.28), rgba(74, 222, 128, 0.2)); --taskwatch-life-text: rgba(222, 252, 240, 0.92); --taskwatch-life-muted: rgba(188, 246, 228, 0.74); }
.goal-task-row.surface-life-routine--lagoon { --task-row-bg: linear-gradient(135deg, rgba(146, 213, 255, 0.26), rgba(59, 130, 246, 0.14)); --task-row-border: rgba(59, 130, 246, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(146, 213, 255, 0.26), rgba(59, 130, 246, 0.18)); --taskwatch-life-text: rgba(224, 242, 255, 0.92); --taskwatch-life-muted: rgba(190, 224, 255, 0.72); }
.goal-task-row.surface-life-routine--ember { --task-row-bg: linear-gradient(135deg, rgba(255, 210, 170, 0.28), rgba(249, 115, 22, 0.18)); --task-row-border: rgba(249, 115, 22, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(255, 210, 170, 0.3), rgba(249, 115, 22, 0.2)); --taskwatch-life-text: rgba(255, 240, 230, 0.94); --taskwatch-life-muted: rgba(255, 208, 190, 0.74); }
html[data-theme='light'] .goal-task-row.surface-life-routine { --task-row-shadow: 0 16px 32px rgba(120, 132, 188, 0.28); --task-row-overlay: linear-gradient(135deg, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0.16)); }
html[data-theme='light'] .goal-task-row.surface-life-routine--glass { --task-row-bg: rgba(241, 244, 255, 0.92); --task-row-border: rgba(118, 142, 255, 0.26); --task-row-overlay: linear-gradient(135deg, rgba(99, 102, 241, 0.22), rgba(79, 70, 229, 0.14)); --taskwatch-life-text: rgba(46, 54, 102, 0.94); --taskwatch-life-muted: rgba(82, 96, 150, 0.72); }
html[data-theme='light'] .goal-task-row.surface-life-routine--midnight { --task-row-bg: rgba(226, 228, 255, 0.92); --task-row-border: rgba(92, 91, 255, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(129, 140, 248, 0.24), rgba(79, 70, 229, 0.16)); --taskwatch-life-text: rgba(36, 40, 96, 0.94); --taskwatch-life-muted: rgba(72, 78, 150, 0.72); }
html[data-theme='light'] .goal-task-row.surface-life-routine--slate { --task-row-bg: rgba(222, 244, 255, 0.92); --task-row-border: rgba(82, 168, 255, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(59, 130, 246, 0.22), rgba(37, 99, 235, 0.14)); --taskwatch-life-text: rgba(20, 56, 94, 0.94); --taskwatch-life-muted: rgba(56, 104, 150, 0.72); }
html[data-theme='light'] .goal-task-row.surface-life-routine--charcoal { --task-row-bg: rgba(255, 236, 246, 0.92); --task-row-border: rgba(255, 155, 201, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(244, 114, 182, 0.22), rgba(236, 72, 153, 0.14)); --taskwatch-life-text: rgba(110, 48, 76, 0.94); --taskwatch-life-muted: rgba(134, 60, 92, 0.7); }
html[data-theme='light'] .goal-task-row.surface-life-routine--linen { --task-row-bg: rgba(255, 240, 214, 0.92); --task-row-border: rgba(255, 198, 140, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(247, 144, 9, 0.22), rgba(234, 88, 12, 0.14)); --taskwatch-life-text: rgba(112, 68, 24, 0.94); --taskwatch-life-muted: rgba(138, 92, 46, 0.7); }
html[data-theme='light'] .goal-task-row.surface-life-routine--frost { --task-row-bg: rgba(232, 249, 255, 0.94); --task-row-border: rgba(124, 222, 255, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(59, 191, 255, 0.22), rgba(2, 132, 199, 0.14)); --taskwatch-life-text: rgba(24, 68, 92, 0.94); --taskwatch-life-muted: rgba(32, 92, 132, 0.7); }
html[data-theme='light'] .goal-task-row.surface-life-routine--grove { --task-row-bg: rgba(222, 251, 232, 0.94); --task-row-border: rgba(74, 222, 128, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(22, 163, 74, 0.12)); --taskwatch-life-text: rgba(24, 78, 56, 0.94); --taskwatch-life-muted: rgba(32, 102, 70, 0.7); }
html[data-theme='light'] .goal-task-row.surface-life-routine--lagoon { --task-row-bg: rgba(224, 242, 255, 0.94); --task-row-border: rgba(59, 130, 246, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(56, 189, 248, 0.22), rgba(28, 110, 212, 0.14)); --taskwatch-life-text: rgba(18, 68, 110, 0.94); --taskwatch-life-muted: rgba(30, 92, 136, 0.7); }
html[data-theme='light'] .goal-task-row.surface-life-routine--ember { --task-row-bg: rgba(255, 239, 224, 0.94); --task-row-border: rgba(249, 115, 22, 0.32); --task-row-overlay: linear-gradient(135deg, rgba(253, 186, 116, 0.24), rgba(234, 88, 12, 0.14)); --taskwatch-life-text: rgba(110, 60, 24, 0.94); --taskwatch-life-muted: rgba(134, 76, 34, 0.7); }
.surface-quick-list {
  --surface-quick-bg: linear-gradient(135deg, rgba(174, 233, 255, 0.24), rgba(142, 210, 255, 0.14));
  --surface-quick-border: rgba(124, 222, 255, 0.32);
  --surface-quick-overlay: linear-gradient(135deg, rgba(124, 222, 255, 0.24), rgba(59, 130, 246, 0.12));
  --taskwatch-quick-text: rgba(224, 248, 255, 0.94);
  --taskwatch-quick-muted: rgba(190, 228, 255, 0.74);
  background: var(--surface-quick-bg);
  border-color: var(--surface-quick-border);
  color: var(--taskwatch-quick-text);
}
.task-selector__goal-toggle.surface-quick-list {
  border: 1px solid var(--surface-quick-border);
  background: var(--surface-quick-bg);
  color: var(--taskwatch-quick-text);
}
.goal-task-row.surface-quick-list {
  --task-row-bg: var(--surface-quick-bg);
  --task-row-border: var(--surface-quick-border);
  --task-row-overlay: var(--surface-quick-overlay);
  --taskwatch-quick-text: rgba(224, 248, 255, 0.94);
  --taskwatch-quick-muted: rgba(190, 228, 255, 0.74);
  color: var(--taskwatch-quick-text);
}
.task-selector__task--quick-list { color: var(--taskwatch-quick-text, var(--text-primary)); }
.task-selector__task--quick-list .goal-task-text,
.task-selector__task--quick-list .goal-task-text__inner { color: inherit; }
.task-selector__task--quick-list .task-selector__origin,
.task-selector__task--quick-list .task-selector__origin--dropdown { color: var(--taskwatch-quick-muted, var(--text-secondary)); }
.task-selector__origin--placeholder { display: block; visibility: hidden; min-height: 0.95rem; }
.focus-task.surface-quick-list { color: var(--taskwatch-quick-text, var(--text-primary)); }
.focus-task.surface-quick-list .focus-task__name,
.focus-task.surface-quick-list .goal-task-text__inner { color: inherit; }
.focus-task.surface-quick-list .focus-task__label,
.focus-task.surface-quick-list .focus-task__origin { color: var(--taskwatch-quick-muted, var(--text-secondary)); }
html[data-theme='light'] .surface-quick-list {
  --surface-quick-bg: linear-gradient(135deg, rgba(232, 249, 255, 0.96), rgba(216, 240, 255, 0.94));
  --surface-quick-border: rgba(124, 222, 255, 0.32);
  --surface-quick-overlay: linear-gradient(135deg, rgba(59, 191, 255, 0.18), rgba(2, 132, 199, 0.12));
  --taskwatch-quick-text: rgba(24, 68, 92, 0.94);
  --taskwatch-quick-muted: rgba(32, 92, 132, 0.7);
}
html[data-theme='light'] .goal-task-row.surface-quick-list {
  --taskwatch-quick-text: rgba(24, 68, 92, 0.94);
  --taskwatch-quick-muted: rgba(32, 92, 132, 0.7);
}

.task-selector__task:active { transform: translateY(1px); }
.task-selector__task--active { border-color: var(--accent); background: var(--accent-soft); }
.task-selector__task--completed { opacity: 0.7; font-style: italic; }
.task-selector__task--completed.task-selector__task--active { opacity: 1; }
.task-selector__task-name { font-size: 0.95rem; letter-spacing: 0.02em; }
.task-selector__task-meta { font-size: 0.78rem; letter-spacing: 0.1em; color: var(--text-secondary); text-transform: uppercase; }

.task-selector__empty,
.task-selector__empty-sub { margin: 0; font-size: 0.85rem; letter-spacing: 0.08em; text-transform: uppercase; color: var(--text-muted); }
.task-selector__empty-sub { font-size: 0.75rem; padding: 0.5rem 0; }

.task-selector__goal { display: flex; flex-direction: column; gap: 0.35rem; }
.task-selector__goal-toggle,
.task-selector__bucket-toggle {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.75rem;
  border: 1px solid var(--control-border);
  border-radius: 0.75rem;
  padding: 0.55rem 0.8rem;
  background: var(--control-surface);
  color: var(--text-primary);
  font-size: 0.92rem;
  cursor: pointer;
  box-shadow: none;
  transition: none;
}
.task-selector__goal-info,
.task-selector__bucket-info { display: flex; flex-direction: column; align-items: flex-start; gap: 0.25rem; min-width: 0; flex: 1; }
.task-selector__goal-badge,
.task-selector__bucket-badge { display: inline-flex; align-items: center; justify-content: center; padding: 0.1rem 0.45rem; border-radius: 999px; font-size: 0.58rem; letter-spacing: 0.16em; text-transform: uppercase; font-weight: 700; }
.task-selector__goal-badge { background: rgba(129, 140, 248, 0.2); color: rgba(222, 230, 255, 0.95); box-shadow: inset 0 0 0 1px rgba(99, 102, 241, 0.38); }
.task-selector__bucket-badge { background: rgba(134, 239, 172, 0.16); color: rgba(15, 118, 110, 0.92); box-shadow: inset 0 0 0 1px rgba(32, 195, 147, 0.32); }
html[data-theme='light'] .task-selector__goal-badge { background: rgba(145, 154, 255, 0.18); color: rgba(68, 76, 180, 0.9); box-shadow: inset 0 0 0 1px rgba(96, 111, 255, 0.32); }
html[data-theme='light'] .task-selector__bucket-badge { background: rgba(178, 245, 208, 0.2); color: rgba(26, 126, 98, 0.9); box-shadow: inset 0 0 0 1px rgba(64, 196, 140, 0.3); }
.task-selector__goal-name,
.task-selector__bucket-name { font-size: 0.95rem; letter-spacing: 0.01em; font-weight: 600; color: inherit; max-width: 100%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.task-selector__goal-toggle:hover,
.task-selector__goal-toggle:focus-visible,
.task-selector__bucket-toggle:hover,
.task-selector__bucket-toggle:focus-visible { background: var(--control-surface); border-color: var(--control-border); box-shadow: none; }
.task-selector__goal-toggle:focus-visible,
.task-selector__bucket-toggle:focus-visible,
.task-selector__task:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
.task-selector__chevron { font-size: 1.25rem; line-height: 1; color: var(--text-secondary); }
.task-selector__bucket-content { display: flex; flex-direction: column; gap: 0.55rem; padding-inline-start: 0.85rem; }

/* Focus card */
.focus-task { width: 100%; display: flex; align-items: center; gap: clamp(1.4rem, 4vw, 2.4rem); padding: clamp(0.85rem, 2.6vw, 1.2rem) clamp(1rem, 3vw, 1.45rem); border-radius: 1rem; box-shadow: 0 20px 46px rgba(6, 10, 30, 0.45); transition: box-shadow 180ms ease, transform 180ms ease; }
.focus-task--open { transform: translateY(-1px); box-shadow: 0 26px 60px rgba(6, 10, 30, 0.5); }
.focus-task--empty { opacity: 0.9; }
.focus-task__body { flex: 1; display: flex; flex-direction: column; align-items: center; gap: clamp(0.24rem, 1vw, 0.42rem); background: none; border: none; color: inherit; font: inherit; cursor: pointer; padding: 0; }
.focus-task__body:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
.focus-task__label { font-size: 0.8rem; letter-spacing: 0.16em; text-transform: uppercase; color: var(--text-secondary); text-align: center; width: 100%; }
.focus-task__name { font-size: clamp(0.82rem, 2.4vw, 1.05rem); letter-spacing: 0.02em; color: var(--text-primary); line-height: 1.35; display: block; text-align: center; }
.focus-task__name--placeholder { color: var(--text-muted); }
.focus-task__content { display: grid; grid-template-columns: 1fr; align-items: center; justify-items: center; gap: clamp(0.35rem, 1.5vw, 0.75rem); width: 100%; }
.focus-task__main { display: flex; flex-direction: column; gap: clamp(0.32rem, 1.1vw, 0.55rem); align-items: center; text-align: center; width: 100%; }
.focus-task__main .goal-task-text { width: 100%; display: block; text-align: center; }
.focus-task__main .goal-task-text__inner { display: inline-block; max-width: 100%; text-align: center; }
.focus-task__origin,
.task-selector__origin { display: block; max-width: 100%; font-size: clamp(0.62rem, 2.1vw, 0.88rem); letter-spacing: 0.03em; font-weight: 600; color: var(--text-secondary); text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; line-height: 1.2; }
.focus-task__origin { margin-top: 0.25rem; color: var(--text-primary); }
.task-selector__origin--dropdown { margin-top: 0.35rem; text-align: left; font-size: clamp(0.6rem, 2vw, 0.82rem); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; }
.task-selector__diff,
.task-selector__diff-chip { pointer-events: none; cursor: default; }
.focus-task__diff-chip { transform: scale(1); pointer-events: auto; cursor: pointer; background: none; border: none; padding: 0; display: inline-flex; align-items: center; justify-content: center; }
.focus-task__diff-chip:disabled { cursor: default; opacity: 0.6; }
.task-selector__diff { transform: none; justify-self: end; align-self: center; }
.task-selector__diff-chip { transform: scale(0.92); justify-self: end; align-self: center; }
.goal-task-row__meta .goal-task-diff { transform: scale(0.92); }

/* Dashboard: ensure focus card fully fills the column and content can shrink/wrap */
.taskwatch--dashboard .task-selector-container { width: 100% !important; max-width: none !important; }
.taskwatch--dashboard .focus-task { width: 100%; max-width: none; display: flex; align-items: center; /* keep side widths symmetric so center aligns with full card */ --focus-side-width: 1.1rem; }
.taskwatch--dashboard .focus-task__body { width: auto; max-width: 100%; min-width: 0; flex: 0 1 auto; margin-inline: auto; display: flex; align-items: center; justify-content: center; }
.taskwatch--dashboard .focus-task__content { width: auto; max-width: 100%; }
.taskwatch--dashboard .focus-task__main { width: 100%; }
.taskwatch--dashboard .focus-task__main .goal-task-text { width: 100%; }
.taskwatch--dashboard .focus-task__main .goal-task-text__inner { max-width: 100%; width: 100%; white-space: normal; overflow-wrap: anywhere; word-break: break-word; }
.taskwatch--dashboard .focus-task__origin { max-width: 100%; width: 100%; }
/* Flex placement for side controls */
.taskwatch--dashboard .goal-task-marker { flex: 0 0 var(--focus-side-width); width: var(--focus-side-width); height: var(--focus-side-width); display: flex; align-items: center; justify-content: center; }
.taskwatch--dashboard .focus-task__indicators { flex: 0 0 var(--focus-side-width); width: var(--focus-side-width); display: flex; align-items: center; justify-content: flex-end; margin-left: 0; }

/* Dashboard: hard-center the focus entry text blocks and allow wrapping */
.taskwatch--dashboard .focus-task__label,
.taskwatch--dashboard .focus-task__name,
.taskwatch--dashboard .goal-task-text__inner,
.taskwatch--dashboard .focus-task__origin {
  display: block;
  width: 100%;
  text-align: center;
  white-space: normal;
  overflow: visible;
  text-overflow: unset;
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* Use flex for the internal content stack so it's truly centered within the flexbox */
.taskwatch--dashboard .focus-task__content { display: flex !important; flex-direction: column; align-items: center; justify-content: center; }
.taskwatch--dashboard .focus-task__main { display: flex; flex-direction: column; align-items: center; }

/* Force the left action marker to remain a square in dashboard */
.taskwatch--dashboard .goal-task-marker,
.taskwatch--dashboard .goal-task-marker--action {
  width: var(--focus-side-width) !important;
  height: var(--focus-side-width) !important;
  border-radius: 0.35rem !important;
}

/* Apply the same centering and symmetric side sizing in standard view (Focus page only) */
.taskwatch-page .focus-task { --focus-side-width: 1.1rem; }
.taskwatch-page .goal-task-marker { flex: 0 0 var(--focus-side-width); width: var(--focus-side-width); height: var(--focus-side-width); display: flex; align-items: center; justify-content: center; }
.taskwatch-page .goal-task-marker--action { width: var(--focus-side-width); height: var(--focus-side-width); border-radius: 0.35rem; }
.taskwatch-page .focus-task__indicators { flex: 0 0 var(--focus-side-width); width: var(--focus-side-width); display: flex; align-items: center; justify-content: flex-end; margin-left: 0; }
.taskwatch-page .focus-task__body { flex: 0 1 auto; margin-inline: auto; max-width: 100%; display: flex; align-items: center; justify-content: center; }
.taskwatch-page .focus-task__content { display: flex; flex-direction: column; align-items: center; justify-content: center; max-width: 100%; }
.taskwatch-page .focus-task__main { display: flex; flex-direction: column; align-items: center; width: 100%; }
.taskwatch-page .focus-task__label,
.taskwatch-page .focus-task__name,
.taskwatch-page .goal-task-text__inner,
.taskwatch-page .focus-task__origin { display: block; width: 100%; text-align: center; white-space: normal; overflow-wrap: anywhere; word-break: break-word; }

/* Ensure dropdown list entries are left-aligned, not centered like the focus card */
.task-selector-popover .goal-task-text__inner { text-align: left; }
.task-selector-popover .task-selector__task-content { align-items: flex-start; }
/* Ensure the difficulty chip stays right-aligned in the selector */
.task-selector-popover .task-selector__task-main { grid-template-columns: 1fr auto; }
.task-selector-popover .task-selector__task.goal-task-row .goal-task-text { white-space: normal; }
.task-selector-popover .task-selector__task.goal-task-row .goal-task-text__inner { overflow-wrap: anywhere; word-break: break-word; }
.task-selector-popover .task-selector__diff,
.task-selector-popover .task-selector__diff-chip {
  justify-self: end !important;
  align-self: center !important;
  margin-left: auto; /* defensive: if layout falls back to flex */
}

/* Snapback button width relative to stopwatch card/column */
.taskwatch--dashboard .snapback-tool__button { width: 80%; max-width: 100%; margin-inline: auto; }
.focus-task__chevron { display: inline-flex; align-items: center; justify-content: center; width: clamp(1.1rem, 4vw, 1.45rem); height: clamp(1.1rem, 4vw, 1.45rem); color: var(--text-secondary); transition: transform 180ms ease; }
.focus-task__indicators { display: inline-flex; align-items: center; gap: clamp(0.25rem, 1.4vw, 0.45rem); margin-left: clamp(0.35rem, 1.8vw, 0.65rem); }
.focus-task__chevron--open { transform: rotate(180deg); }

/* Page heading */
.stopwatch-heading { margin: 0; align-self: center; font-family: var(--font-display); font-weight: 600; letter-spacing: 0.06em; font-size: clamp(2.2rem, 6vw, 3.8rem); color: var(--text-primary); }
/* Dashboard header scales a touch differently without affecting standard layout */
.taskwatch--dashboard .stopwatch-heading { letter-spacing: 0.05em; font-size: clamp(1.9rem, 5vw, 3rem); }
.time-mode-toggle {
  display: inline-flex;
  width: min(420px, 100%);
  height: 46px;
  margin: 0.75rem 0 0.5rem;
  padding: 4px;
  gap: 0.35rem;
  border-radius: 999px;
  background: linear-gradient(135deg, rgba(10, 28, 58, 0.95) 0%, rgba(8, 22, 46, 0.94) 100%);
  border: 1px solid rgba(100, 150, 220, 0.35);
  box-shadow: 0 16px 40px rgba(4, 10, 26, 0.36), inset 0 1px 0 rgba(255, 255, 255, 0.1);
}
.time-mode-toggle__button {
  position: relative;
  z-index: 1;
  flex: 1 1 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  background: transparent;
  color: rgba(255, 255, 255, 0.72);
  border-radius: 999px;
  font-weight: 700;
  letter-spacing: 0.08em;
  font-size: 0.92rem;
  text-transform: uppercase;
  cursor: pointer;
  transition: color 200ms ease, box-shadow 200ms ease;
}
.time-mode-toggle__button::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 999px;
  background: linear-gradient(135deg, #2b7cff 0%, #1f9bff 50%, #17b7ff 100%);
  opacity: 0;
  transition: opacity 200ms ease;
  z-index: -1;
}
.time-mode-toggle__button--active::before {
  opacity: 1;
}
.time-mode-toggle__button--active {
  background: transparent;
  color: #ffffff;
  box-shadow: none;
}

.time-mode-toggle__text {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.time-mode-toggle__dot {
  position: absolute;
  right: 100%;
  top: 50%;
  transform: translateY(-50%);
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background-color: var(--status-idle);
  box-shadow: 0 0 6px var(--status-idle);
  transition: background-color 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
  opacity: 0.6;
  margin-right: 0.5rem;
}
.time-mode-toggle__dot.status-running {
  background-color: var(--status-running);
  box-shadow: 0 0 8px var(--status-running);
  opacity: 1;
}
.time-mode-toggle__dot.status-paused {
  background-color: var(--status-paused);
  box-shadow: 0 0 8px var(--status-paused);
  opacity: 1;
}

html[data-theme='light'] .time-mode-toggle {
  border-color: rgba(0, 0, 0, 0.06);
  background: linear-gradient(135deg, rgba(232, 240, 255, 0.98) 0%, rgba(218, 230, 248, 0.97) 100%);
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.06), inset 0 1px 0 rgba(255, 255, 255, 0.95);
}
html[data-theme='light'] .time-mode-toggle__button {
  color: rgba(20, 28, 60, 0.68);
}
html[data-theme='light'] .time-mode-toggle__button::before {
  background: linear-gradient(135deg, #2b7cff 0%, #1f9bff 50%, #17b7ff 100%);
}
html[data-theme='light'] .time-mode-toggle__button--active {
  color: #ffffff;
  box-shadow: none;
}

/* Stopwatch card */
.stopwatch-card { position: relative; display: flex; flex-direction: column; gap: clamp(1.25rem, 3vw, 2rem); padding: clamp(1.8rem, 4.8vw, 2.6rem); padding-top: clamp(2.4rem, 5.4vw, 3.1rem); width: 100%; max-width: min(720px, 100%); border-radius: clamp(18px, 4vw, 28px); border: 1px solid rgba(128, 152, 236, 0.4); background: linear-gradient(155deg, rgba(34, 42, 86, 0.9) 0%, rgba(20, 28, 60, 0.92) 60%, rgba(12, 18, 40, 0.95) 100%); box-shadow: 0 28px 60px -26px rgba(6, 12, 36, 0.85), inset 0 0 0 1px rgba(255, 255, 255, 0.05); overflow: hidden; backdrop-filter: blur(18px); }
.card-clock { position: absolute; top: clamp(1rem, 2.6vw, 1.35rem); left: clamp(1rem, 2.6vw, 1.4rem); display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.4rem 0.8rem; border-radius: 999px; border: 1px solid rgba(128, 152, 236, 0.4); background: rgba(18, 26, 50, 0.72); box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.08); font-family: var(--font-numeric); letter-spacing: 0.16em; font-size: clamp(0.72rem, 1.6vw, 0.92rem); color: var(--text-primary); text-transform: uppercase; }
.stopwatch-card::before { content: ''; position: absolute; inset: 0; border-radius: inherit; border: 1px solid rgba(255, 255, 255, 0.18); box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.08); pointer-events: none; mix-blend-mode: lighten; opacity: 0.7; }
.stopwatch-card::after { content: ''; position: absolute; inset: 3px; border-radius: inherit; background: linear-gradient(180deg, rgba(255, 255, 255, 0.16) 0%, rgba(255, 255, 255, 0.02) 60%, rgba(0, 0, 0, 0.12) 100%); mix-blend-mode: soft-light; pointer-events: none; opacity: 0.55; }
.time-display { display: flex; flex-direction: column; align-items: center; gap: 0.55rem; text-align: center; }
.card-clock-toggle { position: absolute; top: clamp(1rem, 2.6vw, 1.35rem); right: clamp(1rem, 2.6vw, 1.4rem); display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.4rem 0.8rem; border-radius: 999px; border: 1px solid rgba(128, 152, 236, 0.4); background: rgba(18, 26, 50, 0.72); box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.08); font-family: var(--font-numeric); letter-spacing: 0.16em; font-size: clamp(0.72rem, 1.6vw, 0.92rem); color: var(--text-primary); cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease; }
.card-clock-toggle:hover,
.card-clock-toggle:focus-visible { border-color: rgba(178, 198, 255, 0.7); background: rgba(28, 36, 64, 0.82); color: var(--accent); box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.12); }
.card-clock-toggle:focus-visible { outline: 2px solid var(--accent); outline-offset: 3px; }
.time-value--hidden { visibility: hidden; }
.time-label { text-transform: uppercase; letter-spacing: 0.16em; font-size: clamp(0.9rem, 2vw, 1.05rem); font-family: var(--font-display); font-weight: 600; color: var(--text-secondary); }
.time-value { font-family: var(--font-numeric); font-size: clamp(2.4rem, 7.4vw, 4.6rem); font-weight: 600; letter-spacing: 0.03em; font-variant-numeric: tabular-nums; font-feature-settings: 'tnum' 1, 'ss01' 1; color: var(--text-primary); text-shadow: 0 12px 22px rgba(0, 0, 0, 0.18); line-height: 1.05; }

/* Controls */
.controls { display: flex; align-items: center; justify-content: center; gap: clamp(0.75rem, 2.2vw, 1.1rem); flex-wrap: wrap; }
.control {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: clamp(0.78rem, 2.2vw, 1rem) clamp(1.2rem, 3vw, 1.45rem);
  border-radius: 999px;
  border: 1px solid var(--control-border);
  background: linear-gradient(150deg, rgba(139, 132, 255, 0.16) 0%, rgba(47, 212, 255, 0.08) 68%), var(--control-surface);
  color: var(--text-control);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  font-size: clamp(0.86rem, 1.6vw, 1rem);
  font-weight: 600;
  font-family: var(--font-display);
  box-shadow: var(--control-shadow), var(--control-highlight);
  backdrop-filter: blur(12px);
  transition: transform 160ms ease, box-shadow 220ms ease, border 200ms ease, background 200ms ease;
  cursor: pointer;
  flex: 0 0 auto;
  min-width: clamp(108px, 26vw, 138px);
  max-width: 180px;
}
.control::after { content: ''; position: absolute; inset: 4px; border-radius: inherit; background: linear-gradient(180deg, rgba(255, 255, 255, 0.22) 0%, rgba(191, 208, 255, 0.12) 70%, rgba(255, 255, 255, 0) 100%); mix-blend-mode: soft-light; pointer-events: none; opacity: 0.5; }
.control:hover:not(:disabled) { transform: translateY(-2px); background: linear-gradient(150deg, rgba(139, 132, 255, 0.22) 0%, rgba(47, 212, 255, 0.12) 68%), var(--control-surface-hover); box-shadow: var(--control-shadow), var(--control-highlight), 0 14px 26px rgba(10, 18, 48, 0.28); }
.control:focus-visible { outline: 2px solid var(--accent); outline-offset: 3px; }
.control-primary { background: linear-gradient(130deg, var(--accent) 0%, var(--accent-strong) 90%); color: var(--text-control-contrast); border: none; box-shadow: var(--control-shadow), var(--control-highlight), 0 20px 38px rgba(58, 124, 255, 0.32); letter-spacing: 0.12em; }
.control-primary::after { opacity: 0.3; }
.control-primary:hover:not(:disabled) { background: linear-gradient(130deg, var(--accent) 0%, var(--accent-strong) 90%); color: var(--text-control-contrast); box-shadow: var(--control-shadow), var(--control-highlight), 0 24px 44px rgba(58, 124, 255, 0.36), inset 0 1px 0 rgba(255, 255, 255, 0.18); }
.control-secondary { color: var(--text-primary); }
.control-end-session { font-size: clamp(0.8rem, 1.4vw, 0.94rem); letter-spacing: 0.1em; white-space: nowrap; }
.control:disabled { opacity: 0.45; cursor: not-allowed; transform: none; box-shadow: none; }

/* Footer meta */
.meta { text-align: center; color: var(--text-secondary); font-family: var(--font-display); font-size: clamp(0.76rem, 1.4vw, 0.86rem); letter-spacing: 0.14em; text-transform: uppercase; margin: 0; }
.meta-note { margin-top: clamp(0.6rem, 2vw, 1.25rem); }
/* In dashboard, give the meta note extra distance from the columns */
.taskwatch--dashboard .meta-note { margin-top: clamp(2rem, 6vw, 3.6rem); }

/* Notes card */
.taskwatch-notes { width: 100%; max-width: min(720px, 100%); display: flex; flex-direction: column; gap: clamp(0.85rem, 2.2vw, 1.4rem); /* expose padding as a var so children can align/clip to the section edge */ --notes-pad: clamp(1.5rem, 3.8vw, 2.2rem); padding: var(--notes-pad); border-radius: clamp(16px, 3.4vw, 22px); border: 1px solid rgba(118, 142, 255, 0.36); background: linear-gradient(155deg, rgba(14, 18, 48, 0.9) 0%, rgba(10, 16, 40, 0.9) 58%, rgba(8, 14, 36, 0.92) 100%); box-shadow: 0 32px 72px -36px rgba(2, 6, 24, 0.85); backdrop-filter: blur(16px); }
.taskwatch-notes__header { display: flex; align-items: flex-start; justify-content: space-between; gap: clamp(0.85rem, 2.4vw, 1.6rem); }
.taskwatch-notes__heading { display: flex; flex-direction: column; gap: clamp(0.3rem, 1vw, 0.55rem); }
.taskwatch-notes__title { margin: 0; font-family: var(--font-display); text-transform: uppercase; letter-spacing: 0.16em; font-size: clamp(1.05rem, 2.6vw, 1.35rem); color: var(--text-primary); }
.taskwatch-notes__subtitle { margin: 0; color: rgba(197, 207, 255, 0.72); font-size: clamp(0.78rem, 1.6vw, 0.95rem); line-height: 1.4; display: flex; flex-direction: column; gap: 0.2rem; }
.taskwatch-notes__task { font-weight: 600; color: rgba(244, 246, 255, 0.92); }
.taskwatch-notes__context { font-size: clamp(0.7rem, 1.4vw, 0.82rem); letter-spacing: 0.08em; text-transform: uppercase; color: rgba(162, 178, 244, 0.6); }
.taskwatch-notes__clear { display: inline-flex; align-items: center; justify-content: center; padding: clamp(0.3rem, 1vw, 0.45rem) clamp(0.75rem, 1.8vw, 1rem); border-radius: 999px; border: 1px solid rgba(120, 144, 255, 0.45); background: rgba(26, 36, 92, 0.55); color: rgba(198, 208, 255, 0.84); font-family: var(--font-display); font-weight: 600; letter-spacing: 0.12em; font-size: clamp(0.68rem, 1.3vw, 0.82rem); text-transform: uppercase; cursor: pointer; transition: background 160ms ease, border-color 160ms ease, color 160ms ease, opacity 160ms ease; }
.taskwatch-notes__clear:hover,
.taskwatch-notes__clear:focus-visible { background: rgba(52, 64, 140, 0.75); border-color: rgba(150, 174, 255, 0.62); color: #f4f7ff; }
.taskwatch-notes__clear:focus-visible { outline: 2px solid var(--accent); outline-offset: 3px; }
.taskwatch-notes__notes,
.taskwatch-notes__subtasks { display: flex; flex-direction: column; gap: clamp(0.45rem, 1.1vw, 0.65rem); }
.taskwatch-notes .goal-task-details__subtasks-body,
.taskwatch-notes .goal-task-details__subtask-list {
  position: relative;
  overflow: hidden;
  /* Expand the clipping box to the section border, not the inner padding. */
  margin-left: calc(-1 * var(--notes-pad));
  margin-right: calc(-1 * var(--notes-pad));
  padding-left: var(--notes-pad);
  padding-right: var(--notes-pad);
}
.taskwatch-notes__subtasks-row { display: flex; align-items: center; justify-content: space-between; gap: clamp(0.45rem, 1.2vw, 0.8rem); }
.taskwatch-notes__subtasks-header { display: inline-flex; align-items: center; gap: clamp(0.35rem, 1vw, 0.55rem); }
.taskwatch-notes__label { margin: 0; font-size: clamp(0.68rem, 1.3vw, 0.82rem); letter-spacing: 0.12em; text-transform: uppercase; font-weight: 600; color: rgba(180, 194, 255, 0.72); }
.taskwatch-notes__textarea { width: 100%; min-height: clamp(5.2rem, 14vw, 6.5rem); padding: clamp(0.65rem, 1.8vw, 0.9rem) clamp(0.8rem, 2vw, 1.1rem); border-radius: clamp(14px, 3vw, 18px); border: 1px solid rgba(126, 148, 255, 0.28); background: rgba(16, 22, 56, 0.78); color: rgba(238, 240, 255, 0.95); font-size: clamp(0.85rem, 1.8vw, 1rem); line-height: 1.5; resize: vertical; transition: border-color 160ms ease, box-shadow 160ms ease; }
.taskwatch-notes__textarea::placeholder { color: rgba(176, 186, 242, 0.58); }
.taskwatch-notes__textarea:focus { outline: none; border-color: rgba(158, 182, 255, 0.58); box-shadow: 0 0 0 2px rgba(134, 154, 255, 0.28); }
.taskwatch-notes__progress { margin-left: auto; font-family: var(--font-display); font-size: clamp(0.68rem, 1.4vw, 0.8rem); letter-spacing: 0.16em; text-transform: uppercase; color: rgba(196, 206, 255, 0.7); }
.taskwatch-notes__add { margin-left: auto; display: inline-flex; align-items: center; justify-content: center; padding: clamp(0.28rem, 1vw, 0.42rem) clamp(0.7rem, 1.8vw, 0.95rem); border-radius: 999px; border: 1px solid rgba(120, 146, 255, 0.42); background: rgba(30, 40, 96, 0.6); color: rgba(198, 210, 255, 0.88); font-family: var(--font-display); font-weight: 600; letter-spacing: 0.12em; font-size: clamp(0.68rem, 1.3vw, 0.82rem); text-transform: uppercase; cursor: pointer; transition: background 160ms ease, border-color 160ms ease, color 160ms ease, transform 160ms ease; }
.taskwatch-notes__add:hover,
.taskwatch-notes__add:focus-visible { background: rgba(48, 60, 138, 0.82); border-color: rgba(148, 172, 255, 0.62); color: #f4f7ff; transform: translateY(-1px); }
.taskwatch-notes__add:focus-visible { outline: 2px solid var(--accent); outline-offset: 3px; }
.taskwatch-notes__empty-text { margin: 0; font-size: clamp(0.75rem, 1.5vw, 0.85rem); color: rgba(196, 206, 255, 0.68); }
html[data-theme='light'] .taskwatch-notes__empty-text { color: rgba(72, 84, 138, 0.62); }
.taskwatch-notes__list { list-style: none; margin: 0; padding: 0; display: flex; flex-direction: column; gap: clamp(0.45rem, 1.4vw, 0.7rem); }
.taskwatch-notes__item { display: flex; align-items: center; gap: clamp(0.45rem, 1.2vw, 0.7rem); }
.taskwatch-notes__subtask { flex: 1; display: inline-flex; align-items: center; gap: clamp(0.45rem, 1.2vw, 0.7rem); padding: clamp(0.4rem, 1.2vw, 0.55rem) clamp(0.55rem, 1.6vw, 0.85rem); border-radius: clamp(10px, 2vw, 14px); border: 1px solid rgba(122, 146, 255, 0.26); background: rgba(14, 20, 52, 0.78); }
.taskwatch-notes__checkbox { cursor: pointer; }
.taskwatch-notes__input { flex: 1; border: none; background: transparent; color: rgba(236, 240, 255, 0.94); font-size: clamp(0.82rem, 1.6vw, 0.95rem); line-height: 1.4; padding: 0; }
.taskwatch-notes__input::placeholder { color: rgba(186, 196, 244, 0.6); }
.taskwatch-notes__input:focus { outline: none; }
.taskwatch-notes__item--completed .taskwatch-notes__input { text-decoration: line-through; color: rgba(190, 200, 250, 0.75); }
.taskwatch-notes__remove { display: inline-flex; align-items: center; justify-content: center; width: clamp(1.4rem, 3.2vw, 1.6rem); height: clamp(1.4rem, 3.2vw, 1.6rem); border-radius: 0.45rem; border: none; background: rgba(42, 52, 96, 0.55); color: rgba(222, 232, 255, 0.75); font-size: clamp(0.9rem, 2vw, 1rem); cursor: pointer; transition: background 160ms ease, color 160ms ease, transform 160ms ease; }
.taskwatch-notes__remove:hover,
.taskwatch-notes__remove:focus-visible { background: rgba(255, 82, 118, 0.22); color: rgba(255, 158, 178, 0.95); transform: translateY(-1px); }
.taskwatch-notes__remove:focus-visible { outline: 2px solid rgba(255, 158, 178, 0.6); outline-offset: 2px; }

/* Light theme adjustments (Focus only) */
html[data-theme='light'] .card-clock { border-color: rgba(132, 150, 238, 0.48); background: rgba(245, 248, 255, 0.94); box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.75); color: rgba(38, 48, 102, 0.85); }
html[data-theme='light'] .card-clock-toggle { border-color: rgba(132, 150, 238, 0.48); background: rgba(245, 248, 255, 0.94); box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.75); color: rgba(38, 48, 102, 0.85); }
html[data-theme='light'] .card-clock-toggle:hover,
html[data-theme='light'] .card-clock-toggle:focus-visible { border-color: rgba(110, 130, 224, 0.68); background: rgba(235, 240, 255, 0.96); color: rgba(54, 64, 126, 0.95); box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.82); }
html[data-theme='light'] .stopwatch-card { background: linear-gradient(150deg, rgba(255, 255, 255, 0.98) 0%, rgba(241, 246, 255, 0.97) 58%, rgba(229, 236, 255, 0.95) 100%); border-color: rgba(132, 150, 238, 0.58); box-shadow: 0 28px 58px -26px rgba(96, 110, 178, 0.38), inset 0 0 0 1px rgba(255, 255, 255, 0.62); }
html[data-theme='light'] .time-value { color: #1d2252; text-shadow: 0 10px 22px rgba(109, 124, 182, 0.22); }
html[data-theme='light'] .control { background: rgba(255, 255, 255, 0.92); border-color: rgba(128, 146, 240, 0.32); box-shadow: 0 18px 36px -26px rgba(72, 92, 160, 0.32), var(--control-highlight); color: rgba(26, 34, 82, 0.92); backdrop-filter: blur(14px); }
html[data-theme='light'] .control:hover:not(:disabled) { background: linear-gradient(150deg, rgba(255, 255, 255, 0.96) 0%, rgba(238, 243, 255, 0.96) 100%); border-color: rgba(92, 91, 255, 0.38); }
html[data-theme='light'] .control::after { opacity: 0.45; background: linear-gradient(135deg, rgba(92, 91, 255, 0.16) 0%, rgba(31, 200, 255, 0.22) 100%); }
html[data-theme='light'] .control-primary { background: linear-gradient(135deg, #5c5bff 0%, #4f68ff 55%, #1fc8ff 100%); border: none; color: #ffffff; box-shadow: 0 22px 42px -28px rgba(79, 103, 206, 0.5), var(--control-highlight); }
html[data-theme='light'] .control-primary:hover:not(:disabled) { background: linear-gradient(135deg, #6866ff 0%, #4a70ff 52%, #27d0ff 100%); box-shadow: 0 24px 48px -26px rgba(79, 103, 206, 0.52), var(--control-highlight); }
html[data-theme='light'] .control-secondary { color: rgba(38, 48, 100, 0.9); background: rgba(92, 91, 255, 0.12); border-color: rgba(92, 91, 255, 0.26); box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), -12px -14px 26px rgba(255, 255, 255, 0.82), 20px 24px 44px rgba(120, 132, 188, 0.28); }
html[data-theme='light'] .control-secondary:hover:not(:disabled) { background: rgba(92, 91, 255, 0.18); border-color: rgba(92, 91, 255, 0.36); color: rgba(26, 34, 82, 0.94); box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.46), -14px -16px 28px rgba(255, 255, 255, 0.84), 24px 28px 50px rgba(120, 132, 188, 0.32); }

html[data-theme='light'] .taskwatch-notes { border-color: rgba(134, 150, 238, 0.38); background: linear-gradient(150deg, rgba(255, 255, 255, 0.98) 0%, rgba(240, 244, 255, 0.96) 62%, rgba(232, 238, 254, 0.96) 100%); box-shadow: 0 26px 56px -32px rgba(94, 112, 180, 0.28); }
html[data-theme='light'] .taskwatch-notes__subtitle { color: rgba(64, 74, 132, 0.72); }
html[data-theme='light'] .taskwatch-notes__task { color: rgba(40, 48, 106, 0.9); }
html[data-theme='light'] .taskwatch-notes__context { color: rgba(84, 96, 152, 0.56); }
html[data-theme='light'] .taskwatch-notes__clear { border-color: rgba(142, 154, 226, 0.45); background: rgba(214, 220, 255, 0.6); color: rgba(42, 52, 108, 0.78); }
html[data-theme='light'] .taskwatch-notes__clear:hover,
html[data-theme='light'] .taskwatch-notes__clear:focus-visible { background: rgba(180, 192, 250, 0.76); border-color: rgba(132, 146, 224, 0.68); color: rgba(24, 30, 82, 0.92); }
html[data-theme='light'] .taskwatch-notes__label { color: rgba(74, 86, 138, 0.68); }
html[data-theme='light'] .taskwatch-notes__textarea { border-color: rgba(150, 164, 234, 0.34); background: rgba(250, 252, 255, 0.94); color: rgba(42, 50, 108, 0.92); }
html[data-theme='light'] .taskwatch-notes__textarea::placeholder { color: rgba(110, 122, 176, 0.58); }
html[data-theme='light'] .taskwatch-notes__textarea:focus { border-color: rgba(134, 148, 226, 0.62); box-shadow: 0 0 0 2px rgba(126, 140, 220, 0.26); }
html[data-theme='light'] .taskwatch-notes__progress { color: rgba(72, 84, 140, 0.64); }
html[data-theme='light'] .taskwatch-notes__add { border-color: rgba(150, 164, 234, 0.45); background: rgba(212, 220, 255, 0.62); color: rgba(44, 54, 110, 0.78); }
html[data-theme='light'] .taskwatch-notes__add:hover,
html[data-theme='light'] .taskwatch-notes__add:focus-visible { background: rgba(184, 196, 248, 0.78); border-color: rgba(132, 144, 220, 0.65); color: rgba(26, 32, 84, 0.9); }
html[data-theme='light'] .taskwatch-notes__empty { border-color: rgba(156, 168, 236, 0.45); background: rgba(226, 232, 255, 0.6); color: rgba(72, 84, 140, 0.68); }
html[data-theme='light'] .taskwatch-notes__item--completed .taskwatch-notes__input { color: rgba(86, 98, 150, 0.7); }
html[data-theme='light'] .taskwatch-notes__empty:hover,
html[data-theme='light'] .taskwatch-notes__empty:focus-visible { border-color: rgba(138, 150, 224, 0.68); background: rgba(198, 208, 244, 0.76); color: rgba(38, 46, 104, 0.88); }
html[data-theme='light'] .taskwatch-notes__subtask { border-color: rgba(162, 176, 238, 0.32); background: rgba(246, 248, 255, 0.94); }
html[data-theme='light'] .taskwatch-notes__input { color: rgba(46, 54, 108, 0.9); }
html[data-theme='light'] .taskwatch-notes__input::placeholder { color: rgba(108, 120, 172, 0.55); }
html[data-theme='light'] .taskwatch-notes__remove { background: rgba(214, 222, 255, 0.65); color: rgba(72, 82, 134, 0.72); }
html[data-theme='light'] .taskwatch-notes__remove:hover,
html[data-theme='light'] .taskwatch-notes__remove:focus-visible { background: rgba(255, 138, 156, 0.22); color: rgba(182, 62, 86, 0.92); }

/* Stopwatch status */
.status-row { display: flex; justify-content: center; align-items: center; gap: 0.8rem; text-transform: uppercase; letter-spacing: 0.16em; font-size: clamp(0.82rem, 1.9vw, 1rem); font-family: var(--font-display); font-weight: 500; color: var(--text-secondary); }
.status-dot { width: 0.65rem; height: 0.65rem; border-radius: 50%; background: currentColor; box-shadow: 0 0 14px currentColor; }
.status-text { font-weight: 600; letter-spacing: 0.14em; }
.status-running { color: var(--status-running); }
.status-paused { color: var(--status-paused); }
.status-idle { color: var(--status-idle); }

/* Responsive tweaks for stopwatch + controls */
@media (max-width: 720px) {
  .controls { flex-direction: column; align-items: center; gap: 0.75rem; }
  .control { width: min(100%, 180px); margin-inline: auto; }
}

@media (max-width: 540px) {
  .time-value { font-size: clamp(1.9rem, 12.5vw, 3.8rem); letter-spacing: 0.032em; max-width: min(100%, 14ch); }
  .controls { gap: 0.7rem; }
}

@media (max-width: 420px) {
  .stopwatch-card { padding: 1.75rem; }
  .status-row { letter-spacing: 0.16em; }
  .time-value { font-size: clamp(1.8rem, 14.5vw, 3.4rem); letter-spacing: 0.028em; max-width: min(100%, 13ch); }
  .controls { gap: 0.6rem; }
}

@media (min-width: 960px) {
  .stopwatch-card { padding: 3.25rem; }
  .time-value { letter-spacing: 0.1em; }
}
.snapback-option--active { border-color: rgba(126, 58, 242, 0.4); background: linear-gradient(135deg, #3a6df0 0%, #5b4ee0 50%, #7e3af2 100%); color: #ffffff; box-shadow: none; }

.snapback-option-input {
  padding: 0.4rem 0.8rem;
  border-radius: 999px;
  border: 1px solid rgba(150, 170, 255, 0.38);
  background: rgba(60, 72, 156, 0.24);
  color: rgba(220, 228, 255, 0.92);
  font-size: clamp(0.78rem, 1.6vw, 0.9rem);
  outline: none;
  min-width: 12ch;
  pointer-events: auto;
}
.snapback-option-input::placeholder { color: rgba(176, 190, 255, 0.6); }
.snapback-option-input:focus,
.snapback-option-input:focus-visible { border-color: rgba(186, 202, 255, 0.65); background: rgba(92, 108, 198, 0.42); box-shadow: 0 0 0 2px rgba(132, 150, 255, 0.42); }
.snapback-option-input.is-active { border-color: rgba(198, 210, 255, 0.85); background: linear-gradient(135deg, rgba(112, 130, 246, 0.25) 0%, rgba(86, 108, 230, 0.25) 100%); }
.snapback-option-select { appearance: none; min-width: 12rem; }

/* Light theme for inline chip input */
html[data-theme='light'] .snapback-option-input { border-color: rgba(130, 146, 230, 0.42); background: rgba(230, 236, 255, 0.86); color: rgba(42, 56, 112, 0.9); }
html[data-theme='light'] .snapback-option-input::placeholder { color: rgba(92, 108, 168, 0.65); }
html[data-theme='light'] .snapback-option-input:focus,
html[data-theme='light'] .snapback-option-input:focus-visible { border-color: rgba(138, 154, 242, 0.7); background: rgba(220, 232, 255, 0.9); box-shadow: 0 0 0 2px rgba(138, 154, 242, 0.35); }
html[data-theme='light'] .snapback-option-input.is-active { background: linear-gradient(135deg, rgba(158, 172, 248, 0.3) 0%, rgba(130, 148, 238, 0.3) 100%); border-color: rgba(150, 168, 246, 0.9); }

.snapback-panel__label { display: flex; flex-direction: column; gap: clamp(0.4rem, 1.2vw, 0.55rem); }
.snapback-panel__label-text { font-size: clamp(0.78rem, 1.6vw, 0.88rem); color: rgba(186, 198, 255, 0.8); }
.snapback-panel__optional { font-size: 0.75em; letter-spacing: 0.08em; text-transform: uppercase; color: rgba(198, 206, 255, 0.6); }

.snapback-panel__textarea {
  width: 100%;
  min-height: clamp(64px, 14vw, 90px);
  resize: vertical;
  border-radius: clamp(12px, 2vw, 16px);
  border: 1px solid rgba(138, 158, 255, 0.32);
  background: rgba(16, 22, 56, 0.6);
  color: rgba(236, 240, 255, 0.94);
  padding: clamp(0.5rem, 1.6vw, 0.7rem);
  font-size: clamp(0.82rem, 1.6vw, 0.92rem);
  line-height: 1.5;
  transition: border-color 0.18s ease, box-shadow 0.18s ease;
}
.snapback-panel__textarea::placeholder { color: rgba(176, 190, 255, 0.55); }
.snapback-panel__textarea:focus { outline: none; border-color: rgba(194, 210, 255, 0.72); box-shadow: 0 0 0 2px rgba(132, 150, 255, 0.34); }

.snapback-panel__actions { display: flex; justify-content: flex-end; gap: clamp(0.6rem, 2vw, 1rem); }
.snapback-panel__button { padding: 0.5rem 1.1rem; border-radius: 999px; border: 1px solid transparent; font-size: clamp(0.82rem, 1.8vw, 0.92rem); font-weight: 600; letter-spacing: 0.05em; text-transform: uppercase; cursor: pointer; transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease, background 0.18s ease; }
.snapback-panel__button--ghost { background: transparent; border-color: rgba(152, 168, 255, 0.4); color: rgba(214, 220, 255, 0.82); }
.snapback-panel__button--ghost:hover, .snapback-panel__button--ghost:focus-visible { border-color: rgba(182, 198, 255, 0.65); background: rgba(46, 54, 112, 0.65); }
.snapback-panel__button--primary { background: linear-gradient(135deg, #3a6df0 0%, #5b4ee0 50%, #7e3af2 100%); color: #ffffff; border-color: rgba(255, 255, 255, 0.15); box-shadow: none; }
.snapback-panel__button--primary:hover, .snapback-panel__button--primary:focus-visible { transform: none; box-shadow: none; filter: none; }
.snapback-panel__button:focus-visible { outline: 2px solid rgba(180, 196, 255, 0.85); outline-offset: 2px; }

/* Responsive tweaks */
@media (max-width: 580px) {
  .snapback-tool__card { flex-direction: column; align-items: stretch; text-align: center; gap: clamp(0.7rem, 2.6vw, 1rem); }
  .snapback-tool__body { max-width: 100%; align-items: center; }
  .snapback-tool__text { text-align: center; }
  /* Keep same width logic on small viewports (centered, half viewport) */
  .snapback-tool__button { width: min(50vw, 600px); max-width: 100%; }
}

/* Light theme */
html[data-theme='light'] .snapback-tool__card { border-color: rgba(118, 138, 232, 0.4); background: linear-gradient(155deg, rgba(247, 249, 255, 0.98) 0%, rgba(232, 238, 255, 0.97) 60%, rgba(220, 230, 255, 0.96) 100%); box-shadow: 0 24px 48px -28px rgba(118, 130, 206, 0.35), inset 0 0 0 1px rgba(255, 255, 255, 0.5); }
html[data-theme='light'] .snapback-tool__title { color: rgba(36, 44, 102, 0.92); }
html[data-theme='light'] .snapback-tool__text { color: rgba(66, 78, 132, 0.72); }
html[data-theme='light'] .snapback-tool__last { color: rgba(76, 88, 146, 0.68); }
html[data-theme='light'] .snapback-tool__button { border-color: rgba(255, 255, 255, 0.3); background: linear-gradient(135deg, #6390ff 0%, #7e84fc 50%, #9d7efc 100%); box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.3); }
html[data-theme='light'] .snapback-overlay { background: linear-gradient(160deg, rgba(22, 30, 52, 0.42) 0%, rgba(20, 28, 48, 0.42) 100%); }
html[data-theme='light'] .snapback-panel { border-color: rgba(130, 150, 232, 0.38); background: linear-gradient(160deg, rgba(255, 255, 255, 0.99) 0%, rgba(240, 246, 255, 0.98) 60%, rgba(228, 236, 255, 0.97) 100%); box-shadow: 0 42px 82px -28px rgba(122, 138, 206, 0.38), inset 0 1px 0 rgba(255, 255, 255, 0.7); }
html[data-theme='light'] .snapback-panel__close { border-color: rgba(142, 158, 232, 0.4); background: rgba(214, 220, 255, 0.72); color: rgba(54, 64, 128, 0.8); }
html[data-theme='light'] .snapback-panel__title { color: rgba(34, 44, 102, 0.9); }
html[data-theme='light'] .snapback-panel__lead { color: rgba(70, 82, 140, 0.7); }
html[data-theme='light'] .snapback-panel__context { background: rgba(240, 244, 255, 0.86); border-color: rgba(140, 156, 230, 0.34); }
html[data-theme='light'] .snapback-panel__context-label { color: rgba(94, 108, 168, 0.66); }
html[data-theme='light'] .snapback-panel__context-task { color: rgba(40, 52, 110, 0.86); }
html[data-theme='light'] .snapback-panel__context-meta { color: rgba(82, 96, 150, 0.66); }
html[data-theme='light'] .snapback-panel__heading { color: rgba(42, 56, 122, 0.82); }
html[data-theme='light'] .snapback-panel__section { border-color: rgba(132, 148, 230, 0.35); background: rgba(241, 245, 255, 0.9); box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.86); }
html[data-theme='light'] .snapback-option { border-color: rgba(130, 146, 230, 0.42); background: rgba(230, 236, 255, 0.82); color: rgba(46, 56, 126, 0.78); }
html[data-theme='light'] .snapback-option--active { background: linear-gradient(135deg, #6390ff 0%, #7e84fc 50%, #9d7efc 100%); border-color: rgba(152, 170, 242, 0.4); color: #ffffff; box-shadow: none; }
html[data-theme='light'] .snapback-panel__label-text { color: rgba(76, 88, 146, 0.7); }
html[data-theme='light'] .snapback-panel__optional { color: rgba(94, 108, 160, 0.5); }
html[data-theme='light'] .snapback-panel__textarea { border-color: rgba(128, 144, 228, 0.4); background: rgba(244, 247, 255, 0.95); color: rgba(32, 42, 92, 0.9); }
html[data-theme='light'] .snapback-panel__textarea::placeholder { color: rgba(110, 124, 178, 0.58); }
html[data-theme='light'] .snapback-panel__button--ghost { border-color: rgba(120, 134, 214, 0.45); color: rgba(42, 56, 112, 0.82); }
html[data-theme='light'] .snapback-panel__button--ghost:hover, html[data-theme='light'] .snapback-panel__button--ghost:focus-visible { background: rgba(214, 222, 255, 0.7); }
html[data-theme='light'] .snapback-panel__button--primary { background: linear-gradient(135deg, #6390ff 0%, #7e84fc 50%, #9d7efc 100%); border-color: rgba(255, 255, 255, 0.3); box-shadow: none; }

/* (dashboard-specific compaction overrides removed to restore standard card styles) */

.focus-group-header {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  width: 100%;
  align-items: center;
}
